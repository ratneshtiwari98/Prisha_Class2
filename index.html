<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Breathing Life: Respiratory & Circulatory Systems</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for font and background colors based on new palette */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F1F5F9; /* Page bg: slate-100 */
            color: #334155; /* Text (body): slate-700 */
            -webkit-user-select: auto; /* Allow text selection */
            -moz-user-select: auto;
            -ms-user-select: auto;
            user-select: auto;
        }
        .header-section {
            background-color: #0F766E; /* Primary (tabs active, header/footer): Teal 700 */
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
            text-align: center;
            border-bottom-left-radius: 1.5rem;
            border-bottom-right-radius: 1.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .tabs-container {
            background-color: #FFFFFF; /* Card bg */
            border-radius: 1.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            margin-bottom: 2.5rem;
            border: 1px solid #E2E8F0; /* Borders */
            overflow: hidden; /* To contain rounded corners */
        }
        .tab-buttons {
            display: flex;
            flex-wrap: wrap; /* Allow wrapping on small screens */
            border-bottom: 1px solid #E2E8F0; /* Borders */
            background-color: #F0FDFA; /* Primary hover/surface: Teal 50 */
            padding: 0.5rem;
            border-top-left-radius: 1.5rem;
            border-top-right-radius: 1.5rem;
        }
        .tab-button {
            flex: 1 1 auto; /* Allow items to grow and shrink, minimum width to prevent squishing */
            padding: 1rem 1.5rem;
            cursor: pointer;
            font-weight: 600;
            color: #334155; /* Text (body): slate-700 */
            transition: all 0.3s ease;
            text-align: center;
            border-radius: 0.75rem; /* Slightly rounded buttons */
            margin: 0.25rem; /* Space between buttons */
            white-space: nowrap; /* Prevent text wrapping inside button */
        }
        .tab-button.active {
            background-color: #0F766E; /* Primary (tabs active, header/footer): Teal 700 */
            color: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .tab-content {
            padding: 2rem;
        }
        .content-block {
            background-color: #FFFFFF; /* Card bg */
            padding: 1rem 0; /* Adjusted padding within tab content */
            margin-bottom: 1.5rem; /* Spacing between sections within a tab */
        }
        .highlight-box {
            background-color: #ECFDF5; /* Success/highlight surface */
            border-left: 5px solid #10B981; /* Success/highlight border */
            padding: 1rem;
            border-radius: 0.75rem;
            margin-top: 1rem;
            font-style: italic;
        }
        .fun-fact {
            background-color: #FFFBEB; /* Fun/warm accent surface */
            border-left: 5px solid #F59E0B; /* Fun/warm accent border */
            padding: 1rem;
            border-radius: 0.75rem;
            margin-top: 1rem;
            font-weight: 500;
        }
        .anatomy-table {
            width: 100%; /* Ensure table takes full width */
            border-collapse: collapse;
            border-radius: 1rem; /* Rounded corners for the entire table */
            overflow: hidden; /* Ensures rounded corners are applied */
        }
        .anatomy-table th, .anatomy-table td {
            padding: 0.75rem 1rem;
            border: 1px solid #E2E8F0; /* Borders */
            text-align: left;
        }
        .anatomy-table th {
            background-color: #E0F2FE; /* Info (secondary accent) surface */
            font-weight: 600;
        }
        .anatomy-table tr:nth-child(even) {
            background-color: #F8FAFC; /* Lighter shade for table rows */
        }
        .transition-section {
            background-color: #FFE4E6; /* Alert/transition surface */
            border-left: 5px solid #E11D48; /* Alert/transition border */
            padding: 2.5rem;
            margin-bottom: 2.5rem;
            border-radius: 1.5rem;
            text-align: center;
            font-size: 1.75rem;
            font-weight: bold;
            color: #9F1239; /* Alert/transition text Rose 800 */
        }
        .footer-section {
            background-color: #115E59; /* Primary (footer deeper): Teal 800 */
            color: white;
            padding: 2rem;
            text-align: center;
            border-top-left-radius: 1.5rem;
            border-top-right-radius: 1.5rem;
            margin-top: 2rem;
        }
        /* Hidden by default, activated by JS */
        .tab-pane {
            display: none;
        }
        .tab-pane.active {
            display: block;
        }
        /* Text colors updated according to the new palette */
        .text-gray-800 { /* For H2 headings */
            color: #0F172A; /* Headings: slate-900 */
        }
        .text-blue-700 { /* For H3 headings */
            color: #0369A1; /* Info (secondary accent): Sky 700 */
        }
        .text-green-700 { /* For Prevention text */
            color: #047857; /* Success/highlight: Emerald 700 */
        }
        .text-red-700 { /* For Blood Pressure warning */
            color: #9F1239; /* Alert/transition text: Rose 800 */
        }
        .text-purple-700, .text-blue-800, .text-purple-600 { /* For Summary/Recap texts */
            color: #0F172A; /* Headings: slate-900 */
        }
        
        /* New Quiz Styles */
        .quiz-container-flex {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .quiz-option-btn {
            padding: 1rem;
            border: 1px solid #E2E8F0;
            border-radius: 0.75rem;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            font-weight: 500;
            text-align: left;
        }

        .quiz-option-btn:hover:not(:disabled) {
            background-color: #F0FDFA;
        }
        
        .quiz-option-btn.correct {
            background-color: #ECFDF5;
            border-color: #10B981;
        }

        .quiz-option-btn.incorrect {
            background-color: #FFE4E6;
            border-color: #E11D48;
        }
        
        .btn-primary {
            background-color: #0F766E;
            color: white;
            font-weight: bold;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            transition: all 0.2s;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        .btn-primary:hover:not(:disabled) {
            background-color: #115E59;
        }
        
        .quiz-feedback {
            padding: 1rem;
            border-radius: 0.75rem;
            margin-top: 1rem;
        }

        .quiz-feedback.hidden {
            display: none;
        }

        .feedback-correct-style {
            background-color: #ECFDF5;
            border: 1px solid #10B981;
            color: #047857;
        }

        .feedback-incorrect-style {
            background-color: #FFE4E6;
            border: 1px solid #E11D48;
            color: #9F1239;
        }

        .quiz-sidebar {
            width: 100%;
            padding: 1rem;
            border: 1px solid #E2E8F0;
            border-radius: 1rem;
            background-color: #f9fafb;
            margin-top: 2rem;
        }

        .quiz-sidebar-grid {
            display: grid;
            grid-template-columns: repeat(15, 1fr);
            gap: 0.5rem;
            text-align: center;
        }

        .quiz-sidebar-btn {
            padding: 0.75rem;
            border-radius: 0.5rem;
            border: 1px solid #E2E8F0;
            background-color: #F8FAFC;
            font-weight: bold;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .quiz-sidebar-btn.active-question {
            background-color: #0F766E;
            color: white;
            border-color: #0F766E;
        }

        .quiz-sidebar-btn.answered-correct {
            background-color: #ECFDF5;
            border-color: #047857;
            color: #047857;
        }

        .quiz-sidebar-btn.answered-incorrect {
            background-color: #FFE4E6;
            border-color: #E11D48;
            color: #9F1239;
        }

        .quiz-summary-card {
            background-color: #fefefe;
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border: 1px solid #E2E8F0;
        }
    </style>
</head>
<body class="leading-relaxed">

    <!-- Header Section - Main Title -->
    <header class="header-section">
        <h1 class="text-5xl font-extrabold mb-4">Breathing Life: The Respiratory & Circulatory Systems</h1>
        <p class="text-xl font-medium">From oxygen in the air to energy in your cells. üí® ‚ù§Ô∏è</p>
    </header>

    <main class="container mx-auto p-6 md:p-8 lg:p-10">

        <div class="tabs-container">
            <!-- Tab Buttons -->
            <div class="tab-buttons" id="tab-buttons">
                <button class="tab-button active" data-tab="respiration-intro">Respiratory Intro</button>
                <button class="tab-button" data-tab="respiration-anatomy">Respiratory Anatomy & Gas Exchange</button>
                <button class="tab-button" data-tab="respiration-health">Breathing Mechanics & Respiratory Health</button>
                <button class="tab-button" data-tab="circulation-intro">Circulatory Intro & Heart</button>
                <button class="tab-button" data-tab="circulation-health">Blood, Vessels & Circulatory Health</button>
                <button class="tab-button" data-tab="summary-connection">The Connection & Summary</button>
                <button class="tab-button" data-tab="quiz-content">Quiz</button>
            </div>

            <!-- Tab Content -->
            <div class="tab-content">
                <!-- Tab 1: Introduction to Respiration -->
                <div id="respiration-intro" class="tab-pane active">
                    <section class="content-block">
                        <h2 class="text-3xl font-bold text-gray-800 mb-4 flex items-center"><span class="mr-3">üå¨Ô∏è</span> Introduction to Respiration</h2>
                        <div class="mb-4">
                            <h3 class="text-2xl font-semibold text-blue-700 mb-2">Respiration vs Breathing:</h3>
                            <p class="mb-2"><strong>Breathing</strong> is the physical movement of air into and out of the lungs ‚Äî what happens when you inhale and exhale.</p>
                            <p><strong>Respiration</strong> is a chemical process inside cells, using oxygen from the air to release energy from food.</p>
                        </div>
                        <div class="highlight-box">
                            <p><strong>Real-Life Hook:</strong> "Every time you yawn in class, you‚Äôre actually fixing your oxygen levels!" üò¥</p>
                        </div>
                    </section>

                    <section class="content-block">
                        <h2 class="text-3xl font-bold text-gray-800 mb-4 flex items-center"><span class="mr-3">‚ú®</span> Why We Need a Respiratory System</h2>
                        <ul class="list-disc pl-6 mb-4 space-y-2">
                            <li><strong>Oxygen is crucial for cellular respiration</strong>‚Äîcells use it to release energy from glucose.</li>
                            <li><strong>Removal of CO‚ÇÇ:</strong> When cells make energy, they also produce carbon dioxide (CO‚ÇÇ), which must be removed to prevent blood from becoming too acidic.</li>
                        </ul>
                        <div>
                            <h3 class="text-2xl font-semibold text-blue-700 mb-2">Types of Respiration:</h3>
                            <ul class="list-disc pl-6 space-y-2">
                                <li><strong>Aerobic Respiration:</strong> Uses oxygen, produces a lot of energy.</li>
                                <li><strong>Anaerobic Respiration:</strong> Happens without oxygen (e.g., during heavy exercise), produces less energy and can cause muscle cramps. üèÉ‚Äç‚ôÇÔ∏èüí®</li>
                            </ul>
                        </div>
                    </section>
                </div>

                <!-- Tab 2: Respiratory Anatomy & Gas Exchange -->
                <div id="respiration-anatomy" class="tab-pane">
                    <section class="content-block">
                        <h2 class="text-3xl font-bold text-gray-800 mb-4 flex items-center"><span class="mr-3">üîç</span> Respiratory Anatomy Overview</h2>
                        <div class="overflow-x-auto rounded-xl">
                            <table class="w-full min-w-[600px] anatomy-table">
                                <thead>
                                    <tr>
                                        <th class="rounded-tl-xl">Structure</th>
                                        <th class="rounded-tr-xl">Function</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td>Nose/Mouth</td><td>Entryway for air; nose filters & moistens</td></tr>
                                    <tr><td>Pharynx</td><td>Shared pathway for food and air</td></tr>
                                    <tr><td>Larynx</td><td>Voice box, prevents food from entering airway</td></tr>
                                    <tr><td>Trachea</td><td>Windpipe; keeps airway open</td></tr>
                                    <tr><td>Bronchi</td><td>Two main passageways into lungs</td></tr>
                                    <tr><td>Bronchioles</td><td>Smaller branches dissipating into alveoli</td></tr>
                                    <tr><td>Alveoli</td><td>Tiny sacs where gas exchange happens</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </section>

                    <section class="content-block">
                        <h2 class="text-3xl font-bold text-gray-800 mb-4 flex items-center"><span class="mr-3">üëÉ</span> Nasal Cavity & Pharynx</h2>
                        <ul class="list-disc pl-6 space-y-2">
                            <li>Nasal hairs trap dust and debris.</li>
                            <li>Mucus traps micro-particles and germs. ü§ß</li>
                            <li>Air is warmed & moistened as it passes through, protecting delicate lung tissue.</li>
                            <li><strong>Pharynx:</strong> Acts as a crossroads for food (to esophagus) and air (to trachea).</li>
                        </ul>
                    </section>

                    <section class="content-block">
                        <h2 class="text-3xl font-bold text-gray-800 mb-4 flex items-center"><span class="mr-3">üó£Ô∏è</span> Larynx & Trachea</h2>
                        <ul class="list-disc pl-6 mb-4 space-y-2">
                            <li><strong>Larynx (voice box):</strong> Creates sound, directs air, blocks food entry with the epiglottis during swallowing.</li>
                            <li><strong>Trachea (windpipe):</strong> Has C-shaped cartilage rings to keep it open, even when you move or bend your neck.</li>
                        </ul>
                        <div class="fun-fact">
                            <p><strong>Fun Example:</strong> Choking risk increases if you talk or laugh while eating‚Äîfood can enter the airway by mistake! üò¨</p>
                        </div>
                    </section>

                    <section class="content-block">
                        <h2 class="text-3xl font-bold text-gray-800 mb-4 flex items-center"><span class="mr-3">üå≥</span> Bronchi & Bronchioles</h2>
                        <ul class="list-disc pl-6 space-y-2">
                            <li><strong>Bronchi:</strong> Two main tubes splitting off from trachea, each leading to one lung.</li>
                            <li><strong>Bronchioles:</strong> Smaller branches inside lungs, increasing the total surface area for efficient gas exchange.</li>
                        </ul>
                    </section>

                    <section class="content-block">
                        <h2 class="text-3xl font-bold text-gray-800 mb-4 flex items-center"><span class="mr-3">üéà</span> Alveoli Structure & Function</h2>
                        <ul class="list-disc pl-6 space-y-2">
                            <li><strong>Alveoli:</strong> About 300 million tiny air sacs in both lungs.</li>
                            <li><strong>Structure:</strong> Extremely thin walls (just one cell thick), surrounded by capillaries.</li>
                            <li><strong>Function:</strong> Huge surface area lets more oxygen and carbon dioxide pass between air and blood quickly.</li>
                        </ul>
                    </section>

                    <section class="content-block">
                        <h2 class="text-3xl font-bold text-gray-800 mb-4 flex items-center"><span class="mr-3">‚ÜîÔ∏è</span> Gas Exchange Mechanism</h2>
                        <ul class="list-disc pl-6 space-y-2">
                            <li><strong>O‚ÇÇ diffusion:</strong> Oxygen from alveoli moves into blood because blood has less oxygen.</li>
                            <li><strong>CO‚ÇÇ diffusion:</strong> Carbon dioxide in blood moves into alveoli because alveoli have less CO‚ÇÇ.</li>
                            <li><strong>Hemoglobin:</strong> A protein in red blood cells that binds oxygen and carries it throughout your body. ‚ù§Ô∏è‚Äçü©π</li>
                            <li><strong>Partial Pressure:</strong> O‚ÇÇ and CO‚ÇÇ move due to differences in their concentration (partial pressure) across the alveoli-blood barrier.</li>
                        </ul>
                    </section>
                </div>

                <!-- Tab 3: Breathing Mechanics & Respiratory Health -->
                <div id="respiration-health" class="tab-pane">
                    <section class="content-block">
                        <h2 class="text-3xl font-bold text-gray-800 mb-4 flex items-center"><span class="mr-3">‚¨ÜÔ∏è‚¨áÔ∏è</span> Breathing Mechanism</h2>
                        <div class="mb-4">
                            <h3 class="text-2xl font-semibold text-blue-700 mb-2">Inhalation:</h3>
                            <ul class="list-disc pl-6 space-y-2">
                                <li>Diaphragm contracts & flattens, rib cage moves up.</li>
                                <li>Lung volume increases, air rushes in. üòÆ‚Äçüí®</li>
                            </ul>
                        </div>
                        <div>
                            <h3 class="text-2xl font-semibold text-blue-700 mb-2">Exhalation:</h3>
                            <ul class="list-disc pl-6 space-y-2">
                                <li>Diaphragm relaxes & rises, rib cage moves down.</li>
                                <li>Lung volume decreases, air is pushed out. exhale</li>
                            </ul>
                        </div>
                        <p class="mt-4 font-medium"><strong>Pressure Link:</strong> Changes in lung volume change pressures, causing air movement.</p>
                    </section>

                    <section class="content-block">
                        <h2 class="text-3xl font-bold text-gray-800 mb-4 flex items-center"><span class="mr-3">üß†</span> Control of Breathing</h2>
                        <ul class="list-disc pl-6 mb-4 space-y-2">
                            <li><strong>Medulla oblongata (brain stem):</strong> Controls automatic breathing.</li>
                            <li><strong>CO‚ÇÇ concentration</strong> in blood triggers faster breathing, not low O‚ÇÇ.</li>
                        </ul>
                        <div class="fun-fact">
                            <p><strong>Real-Life Example:</strong> When running, muscles make more CO‚ÇÇ‚Äîbrain tells you to breathe faster! üèÉ‚Äç‚ôÄÔ∏èüí®</p>
                        </div>
                    </section>

                    <section class="content-block">
                        <h2 class="text-3xl font-bold text-gray-800 mb-4 flex items-center"><span class="mr-3">üìè</span> Respiratory Volumes</h2>
                        <ul class="list-disc pl-6 space-y-2">
                            <li><strong>Tidal volume:</strong> Amount of air moved in a normal breath.</li>
                            <li><strong>Vital capacity:</strong> Maximum air you can exhale after a deep breath.</li>
                            <li><strong>Residual volume:</strong> Air left in lungs after full exhalation (keeps lungs from collapsing).</li>
                            <li>Athletes typically have higher vital capacities than non-athletes due to stronger lungs. üèãÔ∏è‚Äç‚ôÇÔ∏è</li>
                        </ul>
                    </section>

                    <section class="content-block">
                        <h2 class="text-3xl font-bold text-gray-800 mb-4 flex items-center"><span class="mr-3">üò∑</span> Diseases of Respiratory System</h2>
                        <ul class="list-disc pl-6 mb-4 space-y-2">
                            <li><strong>Asthma:</strong> Airways narrow, causing difficulty breathing; triggered by allergies.</li>
                            <li><strong>Bronchitis:</strong> Inflammation of bronchi; cough, mucus production.</li>
                            <li><strong>Pneumonia:</strong> Infection filling alveoli with fluid; causes fever, trouble breathing.</li>
                            <li><strong>Emphysema:</strong> Alveoli damage; leads to shortness of breath.</li>
                        </ul>
                        <p class="mt-4 font-semibold text-green-700"><strong>Prevention:</strong> Avoid smoking, pollution, practice good hygiene, regular exercise. ‚úÖ</p>
                    </section>

                    <section class="content-block">
                        <h2 class="text-3xl font-bold text-gray-800 mb-4 flex items-center"><span class="mr-3">üè†</span> Everyday Applications</h2>
                        <ul class="list-disc pl-6 space-y-2">
                            <li><strong>Altitude:</strong> Less oxygen in high mountains = harder to breathe (mountaineers train their lungs!). üèîÔ∏è</li>
                            <li><strong>Deep Breathing:</strong> Activates calming nervous system (parasympathetic). üßò‚Äç‚ôÄÔ∏è</li>
                            <li><strong>Clean Air:</strong> Vital for healthy lungs; pollutants can trigger respiratory problems. üå≥</li>
                        </ul>
                    </section>
                </div>

                <!-- Tab 4: Introduction to Circulation & Heart -->
                <div id="circulation-intro" class="tab-pane">
                    <section class="content-block">
                        <h2 class="text-3xl font-bold text-gray-800 mb-4 flex items-center"><span class="mr-3">üöÄ</span> Transition</h2>
                        <div class="transition-section">
                            ‚ÄúOxygen is ready ‚Äî now let‚Äôs deliver it everywhere!‚Äù üöÄ
                        </div>
                    </section>

                    <section class="content-block">
                        <h2 class="text-3xl font-bold text-gray-800 mb-4 flex items-center"><span class="mr-3">‚ù§Ô∏è</span> Introduction to Circulation</h2>
                        <ul class="list-disc pl-6 space-y-2">
                            <li><strong>Purpose:</strong> Transport nutrients, gases (oxygen and carbon dioxide), hormones, and wastes throughout the body.</li>
                            <li><strong>Closed Circulatory System:</strong> Blood is contained within vessels that form a continuous loop.</li>
                            <li>The heart pumps blood to ensure everything reaches every cell efficiently. üíñ</li>
                        </ul>
                    </section>

                    <section class="content-block">
                        <h2 class="text-3xl font-bold text-gray-800 mb-4 flex items-center"><span class="mr-3">üîÑ</span> Types of Circulation in Humans</h2>
                        <ul class="list-disc pl-6 space-y-2">
                            <li><strong>Pulmonary Circulation:</strong> Carries deoxygenated blood from the heart to the lungs to get oxygen, then back to the heart.</li>
                            <li><strong>Systemic Circulation:</strong> Carries oxygenated blood from the heart to the rest of the body and returns deoxygenated blood back to the heart.</li>
                            <li><strong>Coronary Circulation:</strong> Supplies the heart muscle itself with oxygen and nutrients.</li>
                        </ul>
                    </section>

                    <section class="content-block">
                        <h2 class="text-3xl font-bold text-gray-800 mb-4 flex items-center"><span class="mr-3">üßê</span> Circulatory Anatomy Overview</h2>
                        <div class="overflow-x-auto rounded-xl">
                            <table class="w-full min-w-[600px] anatomy-table">
                                <thead>
                                    <tr>
                                        <th class="rounded-tl-xl">Structure</th>
                                        <th class="rounded-tr-xl">Function</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td>Heart</td><td>Pumps blood throughout the body</td></tr>
                                    <tr><td>Arteries</td><td>Carry oxygen-rich blood away from the heart</td></tr>
                                    <tr><td>Veins</td><td>Carry oxygen-poor blood back to the heart</td></tr>
                                    <tr><td>Capillaries</td><td>Tiny vessels where substances exchange between blood and tissues</td></tr>
                                    <tr><td>Blood</td><td>Transports oxygen, nutrients, wastes, and hormones</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </section>

                    <section class="content-block">
                        <h2 class="text-3xl font-bold text-gray-800 mb-4 flex items-center"><span class="mr-3">ü´Ä</span> The Heart Structure</h2>
                        <h3 class="text-2xl font-semibold text-blue-700 mb-2">Four chambers:</h3>
                        <ul class="list-disc pl-6 mb-4 space-y-2">
                            <li>Right atrium and ventricle (handle deoxygenated blood)</li>
                            <li>Left atrium and ventricle (handle oxygenated blood)</li>
                        </ul>
                        <h3 class="text-2xl font-semibold text-blue-700 mb-2">Valves prevent backflow:</h3>
                        <ul class="list-disc pl-6 mb-4 space-y-2">
                            <li>Tricuspid (right side)</li>
                            <li>Bicuspid or mitral (left side)</li>
                            <li>Semilunar valves control blood leaving ventricles.</li>
                        </ul>
                        <div class="highlight-box">
                            <p><strong>Analogy:</strong> Heart works like a double pump ‚Äî right side sends blood to lungs, left side sends blood to body. ‚öôÔ∏è</p>
                        </div>
                    </section>

                    <section class="content-block">
                        <h2 class="text-3xl font-bold text-gray-800 mb-4 flex items-center"><span class="mr-3">‚û°Ô∏è</span> Blood Flow Pathway</h2>
                        <ul class="list-decimal pl-6 space-y-2">
                            <li>Blood enters right atrium from body via vena cava (deoxygenated).</li>
                            <li>Flows to right ventricle, pumped to lungs via pulmonary artery.</li>
                            <li>Oxygenated blood returns to left atrium via pulmonary veins.</li>
                            <li>Flows into left ventricle, pumped into body through the aorta.</li>
                        </ul>
                        <p class="mt-4 font-medium">This continuous circuit keeps blood moving to deliver oxygen and nutrients. üåê</p>
                    </section>

                    <section class="content-block">
                        <h2 class="text-3xl font-bold text-gray-800 mb-4 flex items-center"><span class="mr-3">‚è∞</span> Cardiac Cycle</h2>
                        <p class="mb-2">Consists of two phases:</p>
                        <ul class="list-disc pl-6 mb-4 space-y-2">
                            <li><strong>Systole:</strong> Heart muscle contracts, pumping blood out.</li>
                            <li><strong>Diastole:</strong> Heart muscle relaxes, chambers fill with blood.</li>
                        </ul>
                        <p class="font-medium mb-2"><strong>Lub-dub sound:</strong> Heart valves closing make these sounds. üíì</p>
                        <p>Each heartbeat involves coordinated atrial and ventricular contractions.</p>
                    </section>

                    <section class="content-block">
                        <h2 class="text-3xl font-bold text-gray-800 mb-4 flex items-center"><span class="mr-3">‚ö°</span> Electrical Activity of the Heart</h2>
                        <ul class="list-disc pl-6 space-y-2">
                            <li><strong>SA node:</strong> Heart‚Äôs natural pacemaker; starts electrical signal.</li>
                            <li><strong>AV node:</strong> Delays signal slightly, allowing ventricles to fill.</li>
                            <li><strong>Purkinje fibers:</strong> Spread signal through ventricles for coordinated contraction.</li>
                        </ul>
                        <p class="mt-4 font-medium"><strong>Electrocardiogram (ECG)</strong> records this electrical activity. üìà</p>
                    </section>
                </div>

                <!-- Tab 5: Blood, Vessels & Circulatory Health -->
                <div id="circulation-health" class="tab-pane">
                    <section class="content-block">
                        <h2 class="text-3xl font-bold text-gray-800 mb-4 flex items-center"><span class="mr-3">üõ£Ô∏è</span> Blood Vessels</h2>
                        <ul class="list-disc pl-6 space-y-2">
                            <li><strong>Arteries:</strong> Thick walls, carry blood under high pressure.</li>
                            <li><strong>Veins:</strong> Thinner walls, have valves to prevent backflow, blood under lower pressure.</li>
                            <li><strong>Capillaries:</strong> One-cell-thick walls, allow exchange of oxygen, nutrients, and waste with tissues.</li>
                        </ul>
                    </section>

                    <section class="content-block">
                        <h2 class="text-3xl font-bold text-gray-800 mb-4 flex items-center"><span class="mr-3">ü©∏</span> Blood Composition</h2>
                        <ul class="list-disc pl-6 space-y-2">
                            <li><strong>Plasma:</strong> Liquid part, carries nutrients, hormones, and waste.</li>
                            <li><strong>Red Blood Cells (RBCs):</strong> Carry oxygen using hemoglobin. üî¥</li>
                            <li><strong>White Blood Cells (WBCs):</strong> Fight infections. ‚ö™</li>
                            <li><strong>Platelets:</strong> Help blood clot to stop bleeding. ü©π</li>
                        </ul>
                    </section>

                    <section class="content-block">
                        <h2 class="text-3xl font-bold text-gray-800 mb-4 flex items-center"><span class="mr-3">‚öñÔ∏è</span> Blood Pressure</h2>
                        <ul class="list-disc pl-6 mb-4 space-y-2">
                            <li><strong>Systolic pressure:</strong> When heart contracts.</li>
                            <li><strong>Diastolic pressure:</strong> When heart relaxes.</li>
                            <li>Normal range: about 120/80 mm Hg.</li>
                        </ul>
                        <p class="font-medium text-red-700">High blood pressure (hypertension) is dangerous and can cause heart disease. üö®</p>
                    </section>

                    <section class="content-block">
                        <h2 class="text-3xl font-bold text-gray-800 mb-4 flex items-center"><span class="mr-3">ü§í</span> Diseases of Circulatory System</h2>
                        <ul class="list-disc pl-6 mb-4 space-y-2">
                            <li><strong>Hypertension:</strong> High blood pressure; risks heart attacks and strokes.</li>
                            <li><strong>Atherosclerosis:</strong> Hardening of arteries due to fatty deposits.</li>
                            <li><strong>Heart attack:</strong> Blockage of blood flow to heart muscle.</li>
                            <li><strong>Stroke:</strong> Disruption of blood flow to the brain.</li>
                        </ul>
                        <p class="mt-4 font-semibold text-green-700"><strong>Prevention:</strong> Healthy diet, regular exercise, no smoking, managing stress. üí™</p>
                    </section>

                    <section class="content-block">
                        <h2 class="text-3xl font-bold text-gray-800 mb-4 flex items-center"><span class="mr-3">üèÉ‚Äç‚ôÄÔ∏è</span> Everyday Applications</h2>
                        <ul class="list-disc pl-6 space-y-2">
                            <li><strong>Face turning red after running:</strong> Blood vessels dilate to release heat. ü•µ</li>
                            <li><strong>Lying down with feet up:</strong> Helps if dizzy by improving blood flow to brain.</li>
                            <li><strong>Checking pulse:</strong> Feeling heartbeat through arteries can monitor heart rate. ü©∫</li>
                        </ul>
                    </section>
                </div>

                <!-- Tab 6: The Connection & Summary -->
                <div id="summary-connection" class="tab-pane">
                    <section class="content-block">
                        <h2 class="text-3xl font-bold text-gray-800 mb-4 flex items-center"><span class="mr-3">ü§ù</span> Respiratory‚ÄìCirculatory Connection</h2>
                        <ul class="list-disc pl-6 space-y-2">
                            <li><strong>Pulmonary circulation</strong> links breathing and circulation.</li>
                            <li>Oxygen enters blood through lungs, travels via red blood cells.</li>
                            <li>Circulatory system delivers oxygen to cells and carries away CO‚ÇÇ.</li>
                        </ul>
                        <p class="mt-4 font-medium">Both systems work together to keep cells energized and alive. üåü</p>
                    </section>

                    <section class="content-block">
                        <h2 class="text-3xl font-bold text-gray-800 mb-4 flex items-center"><span class="mr-3">üó∫Ô∏è</span> Summary Journey</h2>
                        <p class="mb-4">Imagine the incredible journey of oxygen and carbon dioxide:</p>
                        <p class="font-semibold text-lg text-blue-800">Oxygen flow path: <span class="text-green-600">Air</span> &#8594; <span class="text-green-600">lungs</span> &#8594; <span class="text-green-600">alveoli</span> &#8594; <span class="text-red-600">blood</span> &#8594; <span class="text-red-600">heart</span> &#8594; <span class="text-red-600">body cells</span>.</p>
                        <p class="font-semibold text-lg text-blue-800 mt-2">Carbon dioxide path: <span class="text-purple-600">Body cells</span> &#8594; <span class="text-purple-600">blood</span> &#8594; <span class="text-purple-600">heart</span> &#8594; <span class="text-green-600">lungs</span> &#8594; <span class="text-green-600">exhaled air</span>.</p>
                        <p class="mt-4 font-medium">This highlights the amazing teamwork between breathing and blood flow! ü§ù</p>
                    </section>

                    <section class="content-block">
                        <h2 class="text-3xl font-bold text-gray-800 mb-4 flex items-center"><span class="mr-3">‚úÖ</span> Recap & Real-Life Takeaway</h2>
                        <p class="text-2xl font-semibold text-purple-700 mb-4 text-center">‚ÄúBreathing keeps you alive, but circulation makes sure every part of you gets the message.‚Äù</p>
                        <p class="font-medium text-lg text-gray-700 mb-4">It's incredibly important to take care of these vital systems!</p>
                        <p class="font-semibold text-green-700"><strong>Encourage:</strong> Healthy breathing habits, regular exercise, and a heart-healthy lifestyle for overall well-being. Keep learning and stay healthy! üå±</p>
                    </section>
                </div>

                <!-- Tab 7: Quiz -->
                <div id="quiz-content" class="tab-pane">
                    <h2 class="text-4xl font-bold text-gray-800 mb-6 text-center">üß† Test Your Knowledge!</h2>
                    <p class="text-lg text-center mb-6">Ready to see how much you've learned? Take this quick quiz!</p>

                    <div class="flex flex-col quiz-container-flex">
                        <!-- Main Quiz Area -->
                        <div class="flex-grow bg-white p-6 rounded-xl shadow-md border border-gray-200">
                            <div id="question-display" class="mb-6">
                                <p class="text-xl font-semibold mb-4" id="question-text"></p>
                                <div id="options-container" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <!-- Options will be loaded here by JS -->
                                </div>
                            </div>
                            <div id="feedback-display" class="quiz-feedback hidden"></div>
                            <div class="flex justify-between items-center mt-6">
                                <button id="next-btn" class="btn-primary">Next Question</button>
                                <button id="restart-btn" class="btn-primary hidden">Restart Quiz</button>
                                <p class="text-lg font-semibold">Score: <span id="score">0</span> / <span id="total-questions"></span></p>
                            </div>
                        </div>
                    </div>
                    <!-- Quiz Sidebar -->
                    <div class="quiz-sidebar">
                        <h4 class="text-lg font-bold text-gray-800 mb-3">Questions</h4>
                        <div id="quiz-sidebar-nav" class="quiz-sidebar-grid">
                            <!-- Sidebar buttons will be generated here -->
                        </div>
                    </div>
                    <!-- Quiz Summary Section -->
                    <div id="quiz-summary" class="quiz-summary-card mt-8 hidden">
                        <h3 class="text-3xl font-bold text-gray-800 mb-4">Quiz Summary</h3>
                        <p class="text-xl font-semibold mb-4">Final Score: <span id="final-score">0</span> / <span id="total-questions-summary"></span></p>

                        <h4 class="text-2xl font-bold text-blue-700 mb-3">Performance Analysis</h4>
                        <div id="weak-topics-analysis" class="space-y-2">
                            <!-- Topics will be displayed here -->
                        </div>
                        <button id="summary-restart-btn" class="btn-primary mt-6">Restart Quiz</button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer-section">
        <p>&copy; 2025 Breathing Life: Educational Webpage</p>
    </footer>

    <script>
        // Quiz Questions Data (UPDATED with topics)
        const quizQuestions = [
            {
                question: "1. Which part is called the ‚Äúvoice box‚Äù?",
                options: ["A) Trachea", "B) Larynx", "C) Pharynx", "D) Bronchi"],
                answer: "B) Larynx",
                explanation: "The larynx contains your vocal cords and lets you speak.",
                realLife: "When you lose your voice after yelling, your larynx is strained.",
                topic: "Respiratory System"
            },
            {
                question: "2. During inhalation, what happens to the diaphragm?",
                options: ["A) It relaxes and moves up", "B) It contracts and flattens", "C) It stays still", "D) It becomes rounder"],
                answer: "B) It contracts and flattens",
                explanation: "This increases chest volume, lowering air pressure so air flows in.",
                realLife: "Deep belly breathing in yoga uses this movement.",
                topic: "Respiratory System"
            },
            {
                question: "3. Which organ is called the ‚Äúwindpipe‚Äù?",
                options: ["A) Bronchi", "B) Esophagus", "C) Trachea", "D) Alveoli"],
                answer: "C) Trachea",
                explanation: "The trachea connects the larynx to the bronchi and lets air travel to the lungs.",
                realLife: "Coughing happens if something touches your trachea by accident!",
                topic: "Respiratory System"
            },
            {
                question: "4. Which organ controls automatic breathing?",
                options: ["A) Heart", "B) Medulla oblongata", "C) Lungs", "D) Kidneys"],
                answer: "B) Medulla oblongata",
                explanation: "This part of the brain automatically adjusts breath rate.",
                realLife: "You keep breathing‚Äîeven when asleep‚Äîthanks to your brainstem!",
                topic: "Respiratory System"
            },
            {
                question: "5. Which blood vessels are only one cell thick for exchange?",
                options: ["A) Veins", "B) Arteries", "C) Capillaries", "D) Bronchi"],
                answer: "C) Capillaries",
                explanation: "Capillaries allow rapid exchange of gases, nutrients, and waste.",
                realLife: "Red marks (bruises) show up when capillaries are broken under your skin.",
                topic: "Circulatory System"
            },
            {
                question: "6. Which blood vessels carry blood back to the heart?",
                options: ["A) Arteries", "B) Veins", "C) Capillaries", "D) Bronchi"],
                answer: "B) Veins",
                explanation: "Veins have valves that help return blood to the heart.",
                realLife: "The blue lines visible under your skin are veins.",
                topic: "Circulatory System"
            },
            {
                question: "7. High blood pressure is also called:",
                options: ["A) Hypertension", "B) Hypotension", "C) Hyperventilation", "D) Anemia"],
                answer: "A) Hypertension",
                explanation: "Hypertension strains your arteries and organs and raises disease risk.",
                realLife: "Regular exercise and a healthy diet can help prevent it.",
                topic: "Circulatory System"
            },
            {
                question: "8. Tiny sacs in the lungs for gas exchange are called:",
                options: ["A) Bronchi", "B) Pharynx", "C) Alveoli", "D) Nephrons"],
                answer: "C) Alveoli",
                explanation: "Alveoli let oxygen enter blood and remove carbon dioxide.",
                realLife: "Smoking damages alveoli, making breathing difficult.",
                topic: "Respiratory System"
            },
            {
                question: "9. Which chamber pumps oxygenated blood to the whole body?",
                options: ["A) Right atrium", "B) Right ventricle", "C) Left ventricle", "D) Left atrium"],
                answer: "C) Left ventricle",
                explanation: "The left ventricle‚Äôs powerful walls send blood all around your body.",
                realLife: "Exercise strengthens your left ventricle, boosting fitness.",
                topic: "Circulatory System"
            },
            {
                question: "10. Which part keeps the trachea open during neck movement?",
                options: ["A) Smooth muscle", "B) Epiglottis", "C) C-shaped cartilage rings", "D) Diaphragm"],
                answer: "C) C-shaped cartilage rings",
                explanation: "These stiff rings prevent the trachea from collapsing as you move.",
                realLife: "Even when you bend your neck, breathing stays effortless.",
                topic: "Respiratory System"
            },
            {
                question: "11. Which valves control blood leaving the ventricles?",
                options: ["A) Mitral valves", "B) Semilunar valves", "C) Tricuspid valves", "D) Pulmonary veins"],
                answer: "B) Semilunar valves",
                explanation: "Semilunar valves prevent backward flow as blood exits the heart.",
                realLife: "Faulty valves can cause heart murmurs, which doctors listen for.",
                topic: "Circulatory System"
            },
            {
                question: "12. Normal adult blood pressure is around:",
                options: ["A) 60/40 mm Hg", "B) 80/60 mm Hg", "C) 120/80 mm Hg", "D) 140/100 mm Hg"],
                answer: "C) 120/80 mm Hg",
                explanation: "This is the healthy average for adults.",
                realLife: "Doctors use a cuff to measure your blood pressure during checkups.",
                topic: "Circulatory System"
            },
            {
                question: "13. Which type of respiration produces lactic acid and cramps?",
                options: ["A) Aerobic", "B) Anaerobic", "C) External", "D) Internal"],
                answer: "B) Anaerobic",
                explanation: "Anaerobic respiration occurs without oxygen and causes lactic acid buildup.",
                realLife: "Fast running can make your muscles cramp due to this process.",
                topic: "Respiratory System"
            },
            {
                question: "14. The ‚Äúlub-dub‚Äù sound of the heart is due to:",
                options: ["A) Beats of the atria", "B) Opening of blood vessels", "C) Closing of heart valves", "D) Pulsing arteries"],
                answer: "C) Closing of heart valves",
                explanation: "‚ÄúLub‚Äù is the AV valves closing, ‚Äúdub‚Äù is the semilunar valves.",
                realLife: "A stethoscope lets doctors ‚Äúhear‚Äù if your heart sounds normal.",
                topic: "Circulatory System"
            },
            {
                question: "15. What does systolic pressure mean in 120/80 mm Hg?",
                options: ["A) Pressure when heart rests", "B) Pressure with each heartbeat", "C) Pressure in the lungs", "D) Pressure in the veins"],
                answer: "B) Pressure with each heartbeat",
                explanation: "Systolic is the pressure during the heart‚Äôs contraction.",
                realLife: "High systolic pressure signals risks for heart disease.",
                topic: "Circulatory System"
            },
            {
                question: "16. Which structure acts as a crossroads for food and air?",
                options: ["A) Trachea", "B) Pharynx", "C) Alveolus", "D) Larynx"],
                answer: "B) Pharynx",
                explanation: "Both food and air pass through the pharynx before separating.",
                realLife: "Swallowing ‚Äúdown the wrong tube‚Äù happens here.",
                topic: "Respiratory System"
            },
            {
                question: "17. Breathing mainly involves which organs?",
                options: ["A) Lungs and kidneys", "B) Lungs and heart", "C) Lungs and diaphragm", "D) Lungs and liver"],
                answer: "C) Lungs and diaphragm",
                explanation: "The lungs exchange gases, and the diaphragm moves air in and out.",
                realLife: "Hiccups are from diaphragm spasms!",
                topic: "Respiratory System"
            },
            {
                question: "18. Which gas mainly makes you breathe faster?",
                options: ["A) Nitrogen", "B) Oxygen", "C) Carbon dioxide", "D) Helium"],
                answer: "C) Carbon dioxide",
                explanation: "High CO‚ÇÇ in blood signals your brain to increase breathing.",
                realLife: "You pant after exercise to expel more CO‚ÇÇ.",
                topic: "Respiratory System"
            },
            {
                question: "19. Which artery carries deoxygenated blood?",
                options: ["A) Pulmonary artery", "B) Aorta", "C) Coronary artery", "D) Femoral artery"],
                answer: "A) Pulmonary artery",
                explanation: "The pulmonary artery is unique‚Äîit sends ‚Äúused‚Äù blood from the heart to the lungs for oxygen.",
                realLife: "Most arteries carry oxygen-rich blood, but the pulmonary artery is the exception.",
                topic: "Circulatory System"
            },
            {
                question: "20. Why does your face turn red after running?",
                options: ["A) Blood vessels constrict", "B) Capillaries under skin expand", "C) You sweat and cool down", "D) Lungs pump harder"],
                answer: "B) Capillaries under skin expand",
                explanation: "Blood carries extra heat to your skin so you can release it.",
                realLife: "This natural reaction keeps your body from overheating.",
                topic: "Circulatory System"
            },
            {
                question: "21. Which structure warms, moistens, and filters incoming air?",
                options: ["A) Alveoli", "B) Nasal cavity", "C) Trachea", "D) Diaphragm"],
                answer: "B) Nasal cavity",
                explanation: "Tiny hairs and mucus in the nose protect lungs from dust and germs.",
                realLife: "Breathing through your nose protects you better than mouth breathing.",
                topic: "Respiratory System"
            },
            {
                question: "22. Which blood cells fight infections?",
                options: ["A) Red blood cells", "B) Platelets", "C) White blood cells", "D) Plasma"],
                answer: "C) White blood cells",
                explanation: "These cells attack and destroy bacteria and viruses.",
                realLife: "Your ‚Äúswollen glands‚Äù when sick are full of active white blood cells.",
                topic: "Circulatory System"
            },
            {
                question: "23. Which type of circulation is from heart ‚Üí lungs ‚Üí heart?",
                options: ["A) Systemic", "B) Coronary", "C) Pulmonary", "D) Portal"],
                answer: "C) Pulmonary",
                explanation: "Pulmonary circulation exchanges gases in the lungs for the rest of the body.",
                realLife: "Oxygen enters your blood on every trip through the lungs.",
                topic: "Circulatory System"
            },
            {
                question: "24. Which disease destroys alveoli permanently?",
                options: ["A) Asthma", "B) Bronchitis", "C) Pneumonia", "D) Emphysema"],
                answer: "D) Emphysema",
                explanation: "In emphysema, alveoli become damaged, reducing oxygen supply.",
                realLife: "Long-term smoking is the most common cause.",
                topic: "Respiratory System"
            },
            {
                question: "25. Which blood part carries hormones and waste?",
                options: ["A) Red blood cells", "B) Plasma", "C) White blood cells", "D) Platelets"],
                answer: "B) Plasma",
                explanation: "Plasma is the liquid in blood that carries nutrients, hormones, and waste.",
                realLife: "Plasma donation helps save lives in hospitals.",
                topic: "Circulatory System"
            },
            {
                question: "26. Which organ works like a ‚Äúdouble pump‚Äù?",
                options: ["A) Lungs", "B) Heart", "C) Kidney", "D) Liver"],
                answer: "B) Heart",
                explanation: "The left side pumps blood to the body, right side to the lungs.",
                realLife: "Each time your heart beats, these two circuits work together.",
                topic: "Circulatory System"
            },
            {
                question: "27. Which protein in RBCs binds oxygen?",
                options: ["A) Insulin", "B) Hemoglobin", "C) Myosin", "D) Collagen"],
                answer: "B) Hemoglobin",
                explanation: "Hemoglobin attaches to oxygen for delivery to tissues.",
                realLife: "People with anemia may have fewer healthy red cells.",
                topic: "Circulatory System"
            },
            {
                question: "28. Which circulation brings blood to heart muscle itself?",
                options: ["A) Pulmonary", "B) Coronary", "C) Systemic", "D) Portal"],
                answer: "B) Coronary",
                explanation: "Coronary circulation nourishes the heart‚Äôs own cells.",
                realLife: "Blocked coronary arteries cause heart attacks.",
                topic: "Circulatory System"
            },
            {
                question: "29. In gas exchange, oxygen moves due to:",
                options: ["A) Osmosis", "B) Diffusion from high to low concentration", "C) Muscle action", "D) Active transport"],
                answer: "B) Diffusion from high to low concentration",
                explanation: "Oxygen enters blood in the lungs simply because there‚Äôs more of it in the air than in blood.",
                realLife: "Holding your breath builds up carbon dioxide, not oxygen.",
                topic: "Respiratory System"
            },
            {
                question: "30. What prevents food from entering trachea while swallowing?",
                options: ["A) Alveoli", "B) Valve in heart", "C) Epiglottis", "D) Tongue"],
                answer: "C) Epiglottis",
                explanation: "The epiglottis flaps over your windpipe so food goes into the esophagus.",
                realLife: "Choking happens if it doesn‚Äôt work properly.",
                topic: "Respiratory System"
            }
        ];

        // Quiz elements
        const questionDisplay = document.getElementById('question-display');
        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const feedbackDisplay = document.getElementById('feedback-display');
        const nextButton = document.getElementById('next-btn');
        const restartButton = document.getElementById('restart-btn');
        const scoreSpan = document.getElementById('score');
        const totalQuestionsSpan = document.getElementById('total-questions');
        const quizSummary = document.getElementById('quiz-summary');
        const finalScoreSpan = document.getElementById('final-score');
        const totalQuestionsSummarySpan = document.getElementById('total-questions-summary');
        const weakTopicsAnalysisDiv = document.getElementById('weak-topics-analysis');
        const summaryRestartBtn = document.getElementById('summary-restart-btn');
        const quizSidebarNav = document.getElementById('quiz-sidebar-nav');


        // Tab elements
        const tabButtons = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-pane');

        let currentQuestionIndex = 0;
        let score = 0;
        let selectedOptionButton = null;
        let questionStartTime = 0;
        let questionPerformanceData = Array(quizQuestions.length).fill(null); // Initialize with nulls for each question
        let shuffledQuizQuestions = [...quizQuestions]; // Make a mutable copy

        // --- Quiz Functions ---

        function startQuiz() {
            currentQuestionIndex = 0;
            score = 0;
            shuffledQuizQuestions = [...quizQuestions].sort(() => Math.random() - 0.5); // Shuffle on start
            questionPerformanceData = Array(quizQuestions.length).fill(null); // Reset data for new quiz
            totalQuestionsSpan.textContent = quizQuestions.length;
            scoreSpan.textContent = score;
            nextButton.textContent = 'Next Question';
            nextButton.classList.remove('hidden');
            questionDisplay.classList.remove('hidden'); // Show question area
            quizSummary.classList.add('hidden'); // Hide summary
            restartButton.classList.add('hidden');
            summaryRestartBtn.classList.add('hidden');
            
            generateSidebarNav(); // Generate sidebar on quiz start
            loadQuestion(currentQuestionIndex); // Load the first question
        }

        function loadQuestion(index) {
            currentQuestionIndex = index;
            selectedOptionButton = null; // Reset selected option for new question
            feedbackDisplay.classList.add('hidden');
            feedbackDisplay.textContent = '';
            nextButton.disabled = true; // Disable next until an option is selected

            // Update sidebar active state
            updateSidebarActiveState();

            if (currentQuestionIndex < shuffledQuizQuestions.length) {
                const q = shuffledQuizQuestions[currentQuestionIndex];
                questionText.textContent = q.question;
                optionsContainer.innerHTML = ''; // Clear previous options

                q.options.forEach((option, optionIndex) => {
                    const button = document.createElement('button');
                    button.textContent = option;
                    button.classList.add('quiz-option-btn');
                    button.dataset.index = optionIndex; // Store option index
                    button.addEventListener('click', () => selectOption(button, q.answer));
                    optionsContainer.appendChild(button);
                });

                // If question was previously answered, re-select the answer and show feedback
                const performance = questionPerformanceData[currentQuestionIndex];
                if (performance) {
                    const previouslySelectedButton = Array.from(optionsContainer.children).find(
                        btn => btn.textContent === performance.userAnswer
                    );
                    if (previouslySelectedButton) {
                        selectOption(previouslySelectedButton, q.answer, true); // Pass true to prevent re-recording time/score
                    }
                }
                questionStartTime = performance.now(); // Record start time for the question
            } else {
                endQuiz();
            }
        }

        function selectOption(selectedButton, correctAnswer, isReloading = false) {
            if (selectedOptionButton && !isReloading) return; // Prevent re-selection unless reloading

            const questionEndTime = performance.now(); // Record end time
            const timeTaken = ((questionEndTime - questionStartTime) / 1000).toFixed(2); // Time in seconds

            selectedOptionButton = selectedButton; // Mark this option as selected
            nextButton.disabled = false; // Enable next button

            const allOptionButtons = optionsContainer.querySelectorAll('.quiz-option-btn');
            allOptionButtons.forEach(btn => {
                btn.disabled = true; // Disable all options after selection
                if (btn.textContent === correctAnswer) {
                    btn.classList.add('correct'); // Highlight correct answer
                }
            });

            const isCorrect = (selectedButton.textContent === correctAnswer);
            if (isCorrect) {
                if (!isReloading) { // Only update score if not reloading a previously answered question
                    score++;
                    scoreSpan.textContent = score;
                }
                const currentQuestion = quizQuestions.find(q => q.question === shuffledQuizQuestions[currentQuestionIndex].question);
                feedbackDisplay.innerHTML = `<p class="font-bold">Correct!</p><p class="mt-2">${currentQuestion.explanation}</p><p class="mt-1"><strong>Real-life:</strong> ${currentQuestion.realLife}</p>`;
                feedbackDisplay.classList.remove('hidden', 'feedback-incorrect-style');
                feedbackDisplay.classList.add('feedback-correct-style');
            } else {
                selectedButton.classList.add('incorrect'); // Highlight incorrect selection
                const currentQuestion = quizQuestions.find(q => q.question === shuffledQuizQuestions[currentQuestionIndex].question);
                feedbackDisplay.innerHTML = `<p class="font-bold">Incorrect.</p><p class="mt-2">${currentQuestion.explanation}</p><p class="mt-1"><strong>Real-life:</strong> ${currentQuestion.realLife}</p>`;
                feedbackDisplay.classList.remove('hidden', 'feedback-correct-style');
                feedbackDisplay.classList.add('feedback-incorrect-style');
            }

            // Store performance data for this question if not reloading
            if (!isReloading) {
                questionPerformanceData[currentQuestionIndex] = {
                    question: shuffledQuizQuestions[currentQuestionIndex].question,
                    topic: shuffledQuizQuestions[currentQuestionIndex].topic,
                    isCorrect: isCorrect,
                    timeTaken: parseFloat(timeTaken),
                    userAnswer: selectedButton.textContent // Store user's answer
                };
            }

            // Update sidebar button state based on answer
            const sidebarButton = quizSidebarNav.children[currentQuestionIndex];
            if (sidebarButton) {
                sidebarButton.classList.remove('answered-correct', 'answered-incorrect');
                if (isCorrect) {
                    sidebarButton.classList.add('answered-correct');
                } else {
                    sidebarButton.classList.add('answered-incorrect');
                }
            }
        }

        function endQuiz() {
            questionDisplay.classList.add('hidden'); // Hide current question display
            nextButton.classList.add('hidden');

            // Show Quiz Summary
            quizSummary.classList.remove('hidden');
            finalScoreSpan.textContent = score;
            totalQuestionsSummarySpan.textContent = quizQuestions.length;

            analyzeWeakTopics();
        }

        function analyzeWeakTopics() {
            const topicStats = {}; // { "Topic Name": { correct: 0, total: 0, totalTime: 0, incorrectCount: 0 } }

            questionPerformanceData.forEach(data => {
                if (!data) return; // Skip if question not attempted

                if (!topicStats[data.topic]) {
                    topicStats[data.topic] = { correct: 0, total: 0, totalTime: 0, incorrectCount: 0 };
                }
                topicStats[data.topic].total++;
                topicStats[data.topic].totalTime += data.timeTaken;
                if (data.isCorrect) {
                    topicStats[data.topic].correct++;
                } else {
                    topicStats[data.topic].incorrectCount++;
                }
            });

            const topicsForAnalysis = [];
            for (const topic in topicStats) {
                const stats = topicStats[topic];
                const avgTime = stats.totalTime / stats.total;
                topicsForAnalysis.push({
                    name: topic,
                    correct: stats.correct, // For display
                    total: stats.total, // For display
                    avgTime: avgTime // For display
                });
            }

            weakTopicsAnalysisDiv.innerHTML = '';
            if (topicsForAnalysis.length === 0 || questionPerformanceData.every(data => data === null)) {
                weakTopicsAnalysisDiv.innerHTML = '<p class="text-gray-500">No questions attempted yet to analyze topics.</p>';
                return;
            }

            topicsForAnalysis.forEach(topic => {
                const topicElement = document.createElement('div');
                topicElement.classList.add('weak-topic-item');
                topicElement.innerHTML = `
                    <p class="font-semibold text-gray-800">${topic.name}</p>
                    <p class="text-sm">Correct: ${topic.correct} / ${topic.total} questions</p>
                    <p class="text-sm">Average time per question: ${topic.avgTime.toFixed(2)} seconds</p>
                `;
                weakTopicsAnalysisDiv.appendChild(topicElement);
            });
        }

        // --- Sidebar Functions ---
        function generateSidebarNav() {
            quizSidebarNav.innerHTML = ''; // Clear existing buttons
            for (let i = 0; i < shuffledQuizQuestions.length; i++) {
                const sidebarBtn = document.createElement('button');
                sidebarBtn.textContent = i + 1;
                sidebarBtn.classList.add('quiz-sidebar-btn');
                sidebarBtn.dataset.questionIndex = i;
                sidebarBtn.addEventListener('click', () => loadQuestion(i));
                quizSidebarNav.appendChild(sidebarBtn);
            }
            updateSidebarActiveState(); // Set initial active state
        }

        function updateSidebarActiveState() {
            const sidebarButtons = quizSidebarNav.querySelectorAll('.quiz-sidebar-btn');
            sidebarButtons.forEach((btn, index) => {
                btn.classList.remove('active-question');
                // Remove previous answered states before applying new ones
                btn.classList.remove('answered-correct', 'answered-incorrect');

                if (index === currentQuestionIndex) {
                    btn.classList.add('active-question');
                }

                // Apply answered state if data exists
                const performance = questionPerformanceData[index];
                if (performance) {
                    if (performance.isCorrect) {
                        btn.classList.add('answered-correct');
                    } else {
                        btn.classList.add('answered-incorrect');
                    }
                }
            });
        }


        // --- Tab Functions ---
        function setupTabs() {
            tabButtons.forEach(button => {
                button.addEventListener('click', (event) => {
                    const tabId = button.dataset.tab;

                    // Deactivate all buttons and hide all content
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    tabContents.forEach(content => content.classList.remove('active'));

                    // Activate the clicked button
                    button.classList.add('active');

                    // Show the corresponding content
                    const targetContent = document.getElementById(tabId);
                    if (targetContent) {
                        targetContent.classList.add('active');
                    }

                    // Special handling for the quiz tab
                    if (tabId === 'quiz-content') {
                        startQuiz(); // Start the quiz when quiz tab is opened
                    }
                });
            });

            // Set initial active tab
            const initialTabButton = document.querySelector('.tab-button.active');
            if (initialTabButton) {
                const initialTabId = initialTabButton.dataset.tab;
                document.getElementById(initialTabId).classList.add('active');
            }
        }
        
        // Event listeners for quiz buttons
        nextButton.addEventListener('click', () => {
            currentQuestionIndex++;
            if (currentQuestionIndex < shuffledQuizQuestions.length) {
                loadQuestion(currentQuestionIndex);
            } else {
                endQuiz();
            }
        });

        restartButton.addEventListener('click', startQuiz);
        summaryRestartBtn.addEventListener('click', startQuiz);

        // Initial setup on page load
        document.addEventListener('DOMContentLoaded', setupTabs);
    </script>
</body>
</html>
